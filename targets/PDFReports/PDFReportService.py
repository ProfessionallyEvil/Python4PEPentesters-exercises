#!/usr/bin/python

# Service for displaying PDF reports.
import random

import cherrypy
from cherrypy.lib.static import serve_file
import os

class PDFReportService(object):

    @cherrypy.expose
    def index(self):
        return """<html><head><title>PDF Report Viewer</title></head>
        <body><h2>Type customer ID (e.g. "123456") of the report you wish to retrieve.</h2></b>
        <p><form method="post" action="/report">
        Customer ID: <input type="text" name="custid"><br>
        <input type="submit" value="Submit">
        </p>
        </body>
        </html>"""

    @cherrypy.expose
    def report(self, custid):
        path = os.path.abspath("reports/"+custid+".pdf")
        return serve_file(path)

def error_page_404(status, message, traceback, version):
    return "Error - not found"


if __name__ == '__main__':
    cherrypy.config.update({'server.socket_host': '127.0.0.1', 'server.socket_port': 9943, })
    cherrypy.config.update({'error_page.404': error_page_404})
    app = PDFReportService()
    cherrypy.quickstart(app)