#!/usr/bin/python

import random
import datetime

prefix = '172.16'
middle = ['100', '102', '103', '104', '110', '111', '5', '42']
ip_list = []
good_entries = ['"GET / HTTP/1.1" 200 13081',
                '"GET /password HTTP/1.1" 400 226',
                '"GET /contact.php HTTP/1.1" 200 14231',
                '"GET /events.php HTTP/1.1" 200 12239',
                '"GET /services.php HTTP/1.1" 200 178',
                '"GET /favicon.ico HTTP/1.1" 200 1150',
                '"GET /css/main_css.css HTTP/1.1" 200 16130',
                '"GET /_images/welcome.gif HTTP/1.1" 200 178',
                '"GET / HTTP/1.1" 200 13081',
                '"GET / HTTP/1.1" 200 13081']
bad_entries = ['"GET / HTTP/1.1" 200 13081',
               '"GET /password HTTP/1.1" 400 226',
               '"GET /contact.php HTTP/1.1" 200 14231',
               '"GET /events.php HTTP/1.1" 200 12239',
               '"GET /services.php HTTP/1.1" 200 178',
               '"GET /knock.php HTTP/1.1" 400 3069',
               '"GET /knock.php HTTP/1.1" 400 3069']


def generate_ip():
    return '%s.%s.%s' % (prefix, random.choice(middle), str(random.randint(0, 255)))


bad_ip = [generate_ip(), generate_ip(), generate_ip()]

for ip in bad_ip:
    for _ in range(0, 25):
        ip_list.append(ip)

for _ in range(0, 500):
    ip = generate_ip()
    ip_list.append(ip)

print (ip_list)

# Write log
f = open('access.log', 'w')
now = datetime.datetime.now()

for _ in range(0, 1500000):
    ip = random.choice(ip_list)
    now = now + datetime.timedelta(0, 0, 0, random.randint(0, 100))
    resource = ''
    if ip in bad_ip:
        resource = random.choice(bad_entries)
    else:
        resource = random.choice(good_entries)
    f.write('%s - - %s %s\n' % (ip, now.strftime('[%d/%b/%Y:%H:%M:%S -0400]'), resource))
f.close()