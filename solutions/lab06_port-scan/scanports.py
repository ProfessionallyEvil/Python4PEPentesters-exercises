# Exercise: Write a script to open a socket on various ports on localhost.
# HINTS:
# - Consider using the higher-level socket.create_connection method, and set a timeout
# - Some common ports are: 20,21,22,23,80,25,26,37,57,70,110,119,194,389,443,3306,5432,8080
# - Or use a range to test all ports.
# - don't forget you can wrap code in a try - except block.  Use the keyword 'pass' in except blocks to do nothing.
# - print any banners returned by the services
# - scanme.nmap.org
import socket

ports = [20,21,22,23,80,25,26,37,57,70,110,119,194,389,443,3306,5432,8080]
host = 'scanme.nmap.org'

open_ports = []

for port in ports:
    try:
        print("Checking port {} for {}...".format(port, host))
        s = socket.create_connection((host, port), timeout=5.0)
        s.send("test\r\n".encode('utf-8'))
        banner = s.recv(1024)
        s.close()
        print('No exception for {}'.format(port))
        if banner is not None and len(banner) > 0:
            print(banner.decode('utf-8', 'ignore'))
            open_ports.append(port)
    except OSError:
        pass

print (open_ports)

