#!/usr/bin/python

# Run Nikto across a list of hosts and collect the results into a set of result files.
# Do this in a multi-threaded fashion, such that all hosts are queried simultaneously

import subprocess
import threading

hosts = ['http://localhost', 'http://127.0.0.1']

def run_nikto(host):
    print ('Running nikto on '+ host)
    name = host.split('//')[1]
    command = ['nikto', '-host', host, '-output', name+'-nikto.txt']
    subprocess.call(" ".join(command), shell=True)

threads = []

for host in hosts:
    t = threading.Thread(target=run_nikto, args=[host])
    threads.append(t)
    t.start()

for t in threads:
    t.join()

print ('done!')