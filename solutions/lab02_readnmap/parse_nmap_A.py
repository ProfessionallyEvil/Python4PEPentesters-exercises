#! /usr/bin/python

# Given a standard nmap file, generate a dictionary mapping open tcp port numbers to the frequency of that port.
# A sample nmap output file has been provided but this should work on any nmap file.

f = open('mynetwork.nmap','r')
port_counts = {}

for line in f:
    port_end = line.find('/tcp ')       # Find the end of the port number, or -1 if not found
    if port_end > 0:
        port = line[:port_end]          # Parse out the port number from the beginning of the line
        if port not in port_counts:
            port_counts[port] = 1       # Create a new count...
        else:
            port_counts[port] += 1      # or increment an existing count

# close the file
f.close()

# print the results
print (port_counts)