#! /usr/bin/python

# You have encountered a shadow file entry for root on one of the systems
# you are testing.  Use the supplied password dictionary file to see if the root
# admin is using a weak password.  Use crypt.crypt(<password> , <salt>) to see
# if any of them match the value hashed.
#
# shadow entry:
# root:$6$eKgFUeR2$4gCxUJDrZehGdU1HBV2qd33Orby9wfqbvKuy.i0WJL6ktNkI7oEJzAn3VaY42q/m9TGasWvtVwF9PHd.KGM700:16223:0:99999:7:::


import crypt

filename = '500-worst-passwords.txt'
salt = '$6$eKgFUeR2$'
entry = salt + '4gCxUJDrZehGdU1HBV2qd33Orby9wfqbvKuy.i0WJL6ktNkI7oEJzAn3VaY42q/m9TGasWvtVwF9PHd.KGM700'

# Hint: Begin your new code here
    
f = open(filename, 'r')
for line in f:
    print ('testing ' + line.strip())
    if crypt.crypt(line.strip(), salt) == entry:
        print ('MATCHED %s!' % line.strip())
        break

f.close()

