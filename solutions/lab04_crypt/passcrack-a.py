# STEP A:
# Get the basic functionality working as described, using the entry above.  Assuming we may eventually support larger
# wordlist files, provide periodic progress feedback.
# Hints:
# - The salt consists of everything between the first and 3rd '$', including the '$'  (i.e. '$6$eKgFUeR2$'), but crypt can
#   parse out the salt automatically if given the full password.
# - The entry produced by crypt prepends the salt, so it includes everything between the first and second ':'
# - Use the supplied 500-worst-passswords.txt password list (open in 'r' mode)
# - Don't forget to close the file when done
import crypt

entry = 'root:$6$eKgFUeR2$4gCxUJDrZehGdU1HBV2qd33Orby9wfqbvKuy.i0WJL6ktNkI7oEJzAn3VaY42q/m9TGasWvtVwF9PHd.KGM700:16223:0:99999:7:::'
hash = entry.split(':')[1]

# read in password list
f = open('500-worst-passwords.txt', 'r')
for password in f.readlines():
    password = password.strip()
    if crypt.crypt(password, hash) == hash:
        print ("matches: {} ".format(password))

# parse the salt out of our entry (optional)

# for each item in our list, use crypt.crypt(<password> , <salt>)
# compare with the original entry.  Output a match